
// URL del Web App de Apps Script (pega aqu√≠ la tuya; debe terminar en /exec)
const ENDPOINT = 'https://script.google.com/macros/s/AKfycbxa_8ypenVRr-TPfuDyXPhyMjbQyIxbDj6Scn7UGEmrmcohMkVKGGvdcLOyy2hbE63y3g/exec';

document.addEventListener('DOMContentLoaded', () => {
  // Usa el id REAL del formulario seg√∫n tu HTML (en tu captura: correccionForm)
  const form = document.getElementById('miFormulario'); // si lo cambiaste a miFormulario, pon miFormulario aqu√≠
  if (!form) {
    alert('No se encontr√≥ el formulario. Revisa el id (correccionForm o miFormulario).');
    return;
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Prepara datos como FormData ‚Üí evita preflight CORS (simple request)
    const fd = new FormData();
    // OJO: en tu HTML el n√∫mero a portar tiene id="min"
    fd.append('numeroPortacion', document.getElementById('min')?.value?.trim() || '');
    fd.append('cedula',          document.getElementById('cedula')?.value?.trim() || '');
    fd.append('nombre',          document.getElementById('nombre')?.value?.trim() || '');
    fd.append('direccion',       document.getElementById('direccion')?.value?.trim() || '');
    fd.append('barrio',          document.getElementById('barrio')?.value?.trim() || '');
    fd.append('ciudad',          document.getElementById('ciudad')?.value?.trim() || '');
    fd.append('departamento',    document.getElementById('departamento')?.value?.trim() || '');
    fd.append('ventanaCambio',   document.getElementById('ventanaCambio')?.value?.trim() || '');
    fd.append('iccid',           document.getElementById('iccid')?.value?.trim() || '');
    fd.append('contacto',        document.getElementById('contacto')?.value?.trim() || '');
    fd.append('observaciones',   document.getElementById('observaciones')?.value?.trim() || '');
    fd.append('asesor',          document.getElementById('asesor')?.value?.trim() || '');

    try {
      // üî¥ Aqu√≠ es donde va el BODY: el FormData (fd)
      const resp = await fetch(ENDPOINT, {
        method: 'POST',
        mode: 'no-cors',   // evitamos CORS; la respuesta ser√° opaca (no se puede leer JSON)
        body: fd           // ‚Üê ESTE es el body que te falta
      });

      // Como no-cors da respuesta opaca, no podemos leer el id aqu√≠.
      // Pero el Web App s√≠ recibe y guarda en Google Sheets.
      alert('‚úÖ Registro enviado. Revisa la hoja "Repositorio" en Google Sheets.');
      form.reset();
    } catch (error) {
      alert('‚ùå Error de red: ' + error);
    }
  });
});
